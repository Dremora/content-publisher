<% content_for :title, @document.title || "Untitled document" %>

<p id='message' class='govuk-tag'>Document saving...</p>

Document type: <%= @document.document_type %>.

<br/><br/>

<%= form_for @document do |f| %>
  Title:
  <%= f.text_field :title %>

  <br/>
  <br/>
  <br/>
  <%= f.submit "Save" %>
<% end %>

<%= javascript_include_tag "application" %>

<script type="text/javascript">
  this.App || (this.App = {});

  App.cable = ActionCable.createConsumer();

  App.cable.subscriptions.create(
    {
      channel: "DocumentUpdatesChannel",
      id: "<%= params[:id] %>"
    },
    {
    received: function(data) {
      console.log(data);
      document.getElementById('message').innerHTML = data.message
    }
  });
</script>
